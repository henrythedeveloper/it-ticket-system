server {
    listen 80; # Render maps external port 443 (HTTPS) to this internal port 80
    server_name _; # Listen on any hostname internally

    # Proxy API requests to the backend service
    location /api {
        # Replace 'it-helpdesk-backend' with your actual Render backend service name/address
        # Port 8080 is where the Go app listens inside its container
        proxy_pass http://it-helpdesk-backend:8080; # <<< MAKE SURE THIS NAME IS CORRECT

        # Standard proxy headers
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme; # Important for backend to know request used HTTPS

        # Optional: Add timeouts if needed
        # proxy_connect_timeout 60s;
        # proxy_send_timeout 60s;
        # proxy_read_timeout 60s;
    }

    # location / { ... } block is NOT needed here because Render's Static Site
    # hosting handles serving the frontend files and SPA routing based on the
    # rewrite rule (/* -> /index.html) you configured for the Static Site service.
    # Requests to the root domain that don't match /api will be served directly
    # by the Static Site infrastructure associated with this domain.

    # Optional: Add gzip compression if desired
    # gzip on;
    # gzip_vary on;
    # ... other gzip settings
}

# HTTPS server configuration is handled automatically by Render's managed TLS
