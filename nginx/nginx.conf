server {
    listen 80;
    server_name _;

    # --- Add Render's internal DNS resolver ---
    # Use the recommended IPv6 address for Render's internal DNS
    resolver [fdaa::3] valid=10s; # Resolve using Render's DNS, cache for 10s

    location /api {
        # --- Use a variable for the upstream ---
        set $backend_service http://it-helpdesk-backend:8080; # Replace with your exact internal backend name if different
        proxy_pass $backend_service; # Pass to the variable
        # --- End variable usage ---

        # Standard proxy headers
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # No location / block needed for Render Static Site frontend
}

# HTTPS handled by Render
