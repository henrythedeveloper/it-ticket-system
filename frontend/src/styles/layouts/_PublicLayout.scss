// src/styles/layouts/_PublicLayout.scss
// ==========================================================================
// Styles for the public-facing layout (Homepage, FAQ, Create Ticket).
// Includes side navigation and footer.
// **REVISED: Added mobile navigation styles.**
// ==========================================================================

@use '../variables' as *;
@use '../mixins'; // For buttons
@use 'sass:math'; // For calculations

// --- Sticky Theme Toggle Button ---
.theme-toggle-sticky {
  position: fixed;
  top: $spacing-4;
  right: $spacing-4;
  z-index: $z-index-fixed + 10; // Ensure above mobile nav toggle
  background-color: var(--surface-bg);
  color: var(--text-secondary);
  border: 1px solid var(--border-color);
  border-radius: 50%;
  width: 40px; height: 40px;
  display: flex; align-items: center; justify-content: center;
  cursor: pointer;
  box-shadow: $shadow-md;
  transition: background-color $transition-fast, color $transition-fast, border-color $transition-fast, transform $transition-fast;
  font-size: $font-size-lg;

  &:hover {
    background-color: var(--surface-alt-bg);
    color: var(--text-primary);
    transform: scale(1.1);
  }
  &:focus {
    outline: none;
    box-shadow: 0 0 0 3px rgba(var(--primary-rgb), 0.4);
  }
}

// --- Mobile Nav Toggle Button ---
.mobile-nav-toggle {
  display: none; // Hidden by default
  position: fixed;
  top: $spacing-3;
  left: $spacing-3;
  z-index: $z-index-fixed + 10; // High z-index
  background-color: var(--surface-bg);
  color: var(--text-primary);
  border: 1px solid var(--border-color);
  border-radius: $border-radius;
  padding: $spacing-2;
  cursor: pointer;
  box-shadow: $shadow;
  transition: background-color $transition-medium, color $transition-medium, border-color $transition-medium;

  @media (max-width: $breakpoint-md) {
    display: block; // Show on mobile
  }
}

// --- Mobile Nav Overlay ---
.mobile-nav-overlay {
  display: none; // Hidden by default
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background-color: rgba(0, 0, 0, 0.5); // Semi-transparent black
  z-index: $z-index-fixed + 4; // Below nav, above content

  @media (max-width: $breakpoint-md) {
    // Only needed for mobile
    display: block;
    opacity: 0;
    visibility: hidden;
    transition: opacity $transition-medium, visibility $transition-medium;

    // Show overlay when nav is open
    .public-layout .side-nav.mobile-open + & { // Select overlay when nav has mobile-open class
      opacity: 1;
      visibility: visible;
    }
  }
}


// --- Main Layout Container ---
.public-layout {
  display: flex;
  flex-direction: row;
  min-height: 100vh;
  background-color: var(--body-bg);

  // --- Side Navigation ---
  .side-nav {
    width: $sidebar-width; // Fixed width sidebar
    background-color: var(--surface-bg);
    box-shadow: $shadow;
    padding: $spacing-4;
    position: fixed;
    left: 0;
    top: 0;
    height: 100vh;
    display: flex;
    flex-direction: column;
    border-right: 1px solid var(--border-color);
    transition: background-color $transition-medium, border-color $transition-medium, transform $transition-medium; // Add transform transition
    z-index: $z-index-fixed + 5; // Ensure above overlay

    // Logo container
    .logo-container {
      padding: $spacing-4 0; text-align: center;
      margin-bottom: $spacing-6; border-bottom: 1px solid var(--border-color);
      transition: border-color $transition-medium;
      .logo {
        font-size: $font-size-xl; font-weight: $font-weight-bold;
        color: var(--primary);
        text-decoration: none;
        transition: color $transition-fast;
        &:hover { color: var(--primary-dark); }
      }
    }

    // Navigation links list
    .nav-links {
      list-style: none; padding: 0; margin: 0;
      flex-grow: 1;
      li { margin-bottom: $spacing-2;
        a {
          display: flex; align-items: center; padding: $spacing-3 $spacing-4;
          color: var(--text-secondary); text-decoration: none;
          font-weight: $font-weight-medium; border-radius: $border-radius;
          transition: all $transition-fast;
          .icon { margin-right: $spacing-3; font-size: $font-size-xl; }
          &:hover, &.active {
            color: var(--primary);
            background-color: rgba(var(--primary-rgb), 0.1);
          }
        }
      }
    }

    // Authentication buttons
    .auth-buttons {
      padding-top: $spacing-4; border-top: 1px solid var(--border-color);
      transition: border-color $transition-medium;
      .login-btn, .dashboard-btn {
        width: 100%; padding: $spacing-3;
        display: flex; align-items: center; justify-content: center;
        .icon { margin-right: $spacing-2; }
      }
    }

    // Mobile specific styles
    @media (max-width: $breakpoint-md) {
      transform: translateX(-100%); // Hide off-screen by default on mobile
      width: 280px; // Fixed width for mobile overlay menu
      box-shadow: $shadow-lg; // Stronger shadow for overlay

      &.mobile-open {
        transform: translateX(0); // Slide in when open
      }
    }

  } // End .side-nav

  // --- Container for Content + Footer ---
  .content-footer-wrapper {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    flex-grow: 1;
    margin-left: $sidebar-width; // Offset by sidebar width (desktop)
    width: calc(100% - #{$sidebar-width});
    transition: margin-left $transition-medium, width $transition-medium;

    @media (max-width: $breakpoint-md) {
      margin-left: 0; // No margin on mobile
      width: 100%;
    }
  }

  // --- Main Content Area ---
  main.public-content {
    flex-grow: 1;
    padding: $spacing-8;

    @media (max-width: $breakpoint-md) {
      padding: $spacing-6 $spacing-4; // Adjust padding
    }
  }

  // --- Footer ---
  .public-footer {
    background-color: var(--surface-bg);
    color: var(--text-secondary);
    border-top: 1px solid var(--border-color);
    padding: $spacing-6 $spacing-6; // Adjusted padding
    font-size: $font-size-sm;
    transition: background-color $transition-medium, color $transition-medium, border-color $transition-medium;
    flex-shrink: 0;

    .footer-content {
      display: flex; justify-content: space-around; flex-wrap: wrap;
      gap: $spacing-8; max-width: $max-content-width;
      margin: 0 auto $spacing-6 auto; text-align: left;

      .footer-section {
        flex: 1; min-width: 200px;
        h3 { color: var(--text-primary); font-size: $font-size-lg; margin-bottom: $spacing-4; font-weight: $font-weight-semibold; }
        p { color: var(--text-secondary); font-size: $font-size-sm; margin-bottom: $spacing-2; line-height: 1.6; }
        ul { list-style: none; padding: 0; margin: 0;
          li { margin-bottom: $spacing-2;
            a { color: var(--text-link); text-decoration: none; transition: color $transition-fast;
              &:hover { color: var(--text-link-hover); text-decoration: underline; }
            }
          }
        }
      }
    }

    .footer-bottom {
      border-top: 1px solid var(--border-color);
      padding-top: $spacing-4; margin-top: $spacing-6; text-align: center;
      transition: border-color $transition-medium;
      p { color: var(--text-muted); font-size: $font-size-xs; margin: 0; }
    }

    @media (max-width: $breakpoint-md) {
      padding: $spacing-6 $spacing-4; // Adjust padding
      .footer-content { text-align: center; }
    }
  } // End .public-footer
} // End .public-layout

// --- Responsive Adjustments (Simplified - handled within selectors now) ---
