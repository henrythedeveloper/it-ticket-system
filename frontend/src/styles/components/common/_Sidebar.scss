// src/styles/components/common/_Sidebar.scss
// ==========================================================================
// Styles for the Sidebar component.
// FIXED: Use position: fixed only for mobile overlay.
// ==========================================================================

@use '../../variables' as *; // Use variables

// --- Sidebar Styles ---
.sidebar {
  background-color: var(--sidebar-bg, var(--surface-bg)); // Default to surface-bg if sidebar-bg not set
  width: $sidebar-width; // Default width (desktop open)
  height: 100%; // Take full height of parent (.main-container)
  // position: fixed; // REMOVE from base styles
  position: relative; // Use relative or static for normal flow
  // top: 0; // Not needed for relative/static
  // left: 0; // Not needed for relative/static
  z-index: $z-index-fixed - 1; // Adjust z-index if needed
  // padding-top: $header-height; // Padding is handled by parent (.main-container) now
  transition: width $transition-medium, transform $transition-medium, background-color $transition-medium, border-color $transition-medium;
  overflow-y: auto;
  border-right: 1px solid var(--border-color);
  flex-shrink: 0; // Prevent sidebar from shrinking horizontally

  // Navigation list within sidebar
  .sidebar-nav {
    padding: $spacing-4 0; // Add padding back here if needed
    ul {
      list-style: none;
      padding: 0;
      margin: 0;
      li {
        margin-bottom: $spacing-1;
        a {
          display: flex; // Default display is flex
          align-items: center;
          padding: $spacing-3 $spacing-4;
          color: var(--sidebar-text, var(--text-muted)); // Default to text-muted if sidebar-text not set
          text-decoration: none;
          font-weight: $font-weight-medium;
          transition: background-color $transition-fast, color $transition-fast, border-color $transition-fast, padding $transition-medium, justify-content $transition-medium;
          border-left: 3px solid transparent;
          overflow: hidden;
          width: 100%;

          .icon {
            margin-right: $spacing-3;
            font-size: $font-size-lg;
            width: 20px;
            text-align: center;
            flex-shrink: 0;
            transition: margin $transition-medium, opacity $transition-fast, visibility $transition-fast, width $transition-medium;
            opacity: 1;
            visibility: visible;
            display: inline-flex;
            align-items: center;
            justify-content: center;
          }
          span { // The text label
            transition: opacity $transition-fast, visibility $transition-fast, width $transition-medium, margin-left $transition-fast;
            opacity: 1;
            visibility: visible;
            white-space: nowrap;
            width: auto;
            margin-left: 0; // Default margin
          }

          &:hover,
          &.active {
            background-color: rgba(var(--primary-rgb), 0.1);
            color: var(--primary);
            border-left-color: var(--primary);
          }
           &:focus-visible {
               outline: none;
               box-shadow: inset 0 0 0 2px rgba(var(--accent-rgb), 0.5);
           }
        }
      }
    }
  }

  // --- Desktop Collapsed State ---
  @media (min-width: ($breakpoint-md + 1px)) {
    // Apply width change based on parent class
    .main-layout.sidebar-closed & { // Target .sidebar when parent has .sidebar-closed
        width: $sidebar-collapsed-width;

        .sidebar-nav ul li a {
          display: flex;
          justify-content: center;
          align-items: center;
          padding: $spacing-3 0;

          .icon + span { // Hide only the label span
            display: none;
            opacity: 0;
            visibility: hidden;
            width: 0;
            margin-left: -$spacing-3;
          }

          .icon { // Style the icon span
            margin-right: 0;
            opacity: 1;
            visibility: visible;
            width: auto;
          }
        }
    }
  } // --- End Desktop Collapsed State Media Query ---


   // --- Mobile specific styles ---
   @media (max-width: $breakpoint-md) {
      position: fixed; // APPLY position: fixed ONLY for mobile
      top: 0; // Need top/left for fixed positioning
      left: 0; // Need top/left for fixed positioning
      height: 100vh; // Ensure full height on mobile
      transform: translateX(-100%);
      z-index: $z-index-fixed + 5; // Higher z-index for mobile overlay
      width: 280px; // Fixed mobile width
      padding-top: $header-height; // Add padding back for mobile fixed header

      &.mobile-open {
          transform: translateX(0);
          box-shadow: $shadow-lg;
      }

       // Ensure text is visible in mobile overlay mode
       .sidebar-nav ul li a {
           display: flex;
           justify-content: flex-start; // Reset justification for mobile
           padding: $spacing-3 $spacing-4; // Reset padding
           text-align: left;
           span {
             display: inline; // Ensure text is displayed
             opacity: 1;
             visibility: visible;
             width: auto;
             margin-left: 0; // Reset margin
            }
           .icon {
             margin-right: $spacing-3; // Restore margin
             opacity: 1;
             visibility: visible;
             width: 20px; // Restore fixed width if needed
            }
       }
   }

} // End .sidebar
